======================================================================
  DQN Policy Analysis
======================================================================

======================================================================
  Running detailed episode analysis
======================================================================

--- Episode 1 ---

Step 0: Selected 'Monitor'
  Top 5 Q-values:
    Monitor  User4          : Q=  -2.74 <-- SELECTED
    Analyse  Op_Host2       : Q=  -2.76
    Analyse  Op_Host0       : Q=  -2.76
    Analyse  Op_Server0     : Q=  -2.79
    Analyse  Defender       : Q=  -2.79

Step 1: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -5.06 <-- SELECTED
    Analyse  Op_Host0       : Q=  -5.27
    Monitor  User2          : Q=  -5.34
    Monitor  User3          : Q=  -5.38
    Monitor  Op_Host1       : Q=  -5.40

Step 2: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -1.52 <-- SELECTED
    Analyse  User0          : Q=  -1.52
    Analyse  Op_Host0       : Q=  -1.58
    Analyse  User1          : Q=  -1.66
    Analyse  Op_Host2       : Q=  -1.66

Step 3: Selected 'Remove Enterprise1'
  Top 5 Q-values:
    Remove   Enterprise1    : Q=  -3.07 <-- SELECTED
    Analyse  Defender       : Q=  -3.61
    Analyse  User0          : Q=  -3.68
    Monitor  Enterprise0    : Q=  -3.70
    Remove   Op_Host2       : Q=  -3.72

Step 4: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -5.06 <-- SELECTED
    Analyse  Op_Host0       : Q=  -5.27
    Monitor  User2          : Q=  -5.34
    Monitor  User3          : Q=  -5.38
    Monitor  Op_Host1       : Q=  -5.40

Step 5: Selected 'Analyse User0'
  Top 5 Q-values:
    Analyse  User0          : Q=  -1.77 <-- SELECTED
    Analyse  Op_Server0     : Q=  -1.79
    Analyse  Op_Host0       : Q=  -1.81
    Analyse  Op_Host2       : Q=  -1.86
    Remove   Op_Host0       : Q=  -1.91

Step 6: Selected 'Remove Enterprise1'
  Top 5 Q-values:
    Remove   Enterprise1    : Q=  -3.07 <-- SELECTED
    Analyse  Defender       : Q=  -3.56
    Analyse  User0          : Q=  -3.60
    Remove   User0          : Q=  -3.68
    Remove   Op_Host2       : Q=  -3.68

Step 7: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -5.06 <-- SELECTED
    Analyse  Op_Host0       : Q=  -5.27
    Monitor  User2          : Q=  -5.34
    Monitor  User3          : Q=  -5.38
    Monitor  Op_Host1       : Q=  -5.40

Step 8: Selected 'Remove Enterprise1'
  Top 5 Q-values:
    Remove   Enterprise1    : Q=  -3.07 <-- SELECTED
    Analyse  Defender       : Q=  -3.55
    Analyse  User0          : Q=  -3.59
    Remove   Op_Host2       : Q=  -3.67
    Remove   User0          : Q=  -3.68

Step 9: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -5.06 <-- SELECTED
    Analyse  Op_Host0       : Q=  -5.27
    Monitor  User2          : Q=  -5.34
    Monitor  User3          : Q=  -5.38
    Monitor  Op_Host1       : Q=  -5.40

Step 10: Selected 'Remove Enterprise1'
  Top 5 Q-values:
    Remove   Enterprise1    : Q=  -3.07 <-- SELECTED
    Analyse  Defender       : Q=  -3.57
    Analyse  User0          : Q=  -3.62
    Remove   Op_Host2       : Q=  -3.69
    Monitor  Enterprise0    : Q=  -3.69

Step 15: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -5.06 <-- SELECTED
    Analyse  Op_Host0       : Q=  -5.27
    Monitor  User2          : Q=  -5.34
    Monitor  User3          : Q=  -5.38
    Monitor  Op_Host1       : Q=  -5.40

Step 20: Selected 'Remove Enterprise1'
  Top 5 Q-values:
    Remove   Enterprise1    : Q=  -3.07 <-- SELECTED
    Analyse  Defender       : Q=  -3.55
    Analyse  User0          : Q=  -3.59
    Remove   User0          : Q=  -3.67
    Remove   Op_Host2       : Q=  -3.67

Step 25: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -5.06 <-- SELECTED
    Analyse  Op_Host0       : Q=  -5.27
    Monitor  User2          : Q=  -5.34
    Monitor  User3          : Q=  -5.38
    Monitor  Op_Host1       : Q=  -5.40

--- Episode 2 ---

Step 0: Selected 'Monitor'
  Top 5 Q-values:
    Monitor  User4          : Q=  -2.75 <-- SELECTED
    Analyse  Op_Host2       : Q=  -2.77
    Analyse  Op_Host0       : Q=  -2.77
    Analyse  Op_Server0     : Q=  -2.80
    Analyse  Defender       : Q=  -2.80

Step 1: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -5.06 <-- SELECTED
    Analyse  Op_Host0       : Q=  -5.27
    Monitor  User2          : Q=  -5.34
    Monitor  User3          : Q=  -5.38
    Monitor  Op_Host1       : Q=  -5.40

Step 2: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -1.51 <-- SELECTED
    Analyse  User0          : Q=  -1.52
    Analyse  Op_Host0       : Q=  -1.58
    Analyse  Op_Host2       : Q=  -1.66
    Analyse  User1          : Q=  -1.66

Step 3: Selected 'Remove Enterprise1'
  Top 5 Q-values:
    Remove   Enterprise1    : Q=  -3.07 <-- SELECTED
    Analyse  Defender       : Q=  -3.58
    Analyse  User0          : Q=  -3.64
    Monitor  Enterprise0    : Q=  -3.69
    Remove   Op_Host2       : Q=  -3.70

Step 4: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -5.06 <-- SELECTED
    Analyse  Op_Host0       : Q=  -5.27
    Monitor  User2          : Q=  -5.34
    Monitor  User3          : Q=  -5.38
    Monitor  Op_Host1       : Q=  -5.40

Step 5: Selected 'Analyse User0'
  Top 5 Q-values:
    Analyse  User0          : Q=  -1.77 <-- SELECTED
    Analyse  Op_Server0     : Q=  -1.79
    Analyse  Op_Host0       : Q=  -1.81
    Analyse  Op_Host2       : Q=  -1.86
    Remove   Op_Host0       : Q=  -1.91

Step 6: Selected 'Remove Enterprise1'
  Top 5 Q-values:
    Remove   Enterprise1    : Q=  -3.07 <-- SELECTED
    Analyse  Defender       : Q=  -3.56
    Analyse  User0          : Q=  -3.59
    Remove   Op_Host2       : Q=  -3.67
    Remove   User0          : Q=  -3.68

Step 7: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -5.06 <-- SELECTED
    Analyse  Op_Host0       : Q=  -5.27
    Monitor  User2          : Q=  -5.34
    Monitor  User3          : Q=  -5.38
    Monitor  Op_Host1       : Q=  -5.40

Step 8: Selected 'Remove Enterprise1'
  Top 5 Q-values:
    Remove   Enterprise1    : Q=  -3.85 <-- SELECTED
    Analyse  User0          : Q=  -4.15
    Remove   Op_Host2       : Q=  -4.17
    Monitor  Enterprise0    : Q=  -4.19
    Analyse  Defender       : Q=  -4.19

Step 9: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -5.06 <-- SELECTED
    Analyse  Op_Host0       : Q=  -5.27
    Monitor  User2          : Q=  -5.34
    Monitor  User3          : Q=  -5.38
    Monitor  Op_Host1       : Q=  -5.40

Step 10: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -5.06 <-- SELECTED
    Analyse  Op_Host0       : Q=  -5.27
    Monitor  User2          : Q=  -5.34
    Monitor  User3          : Q=  -5.38
    Monitor  Op_Host1       : Q=  -5.40

Step 15: Selected 'Analyse Op_Host0'
  Top 5 Q-values:
    Analyse  Op_Host0       : Q=  -5.63 <-- SELECTED
    Remove   Enterprise1    : Q=  -5.66
    Analyse  Op_Host2       : Q=  -5.69
    Monitor  Defender       : Q=  -5.70
    Remove   Op_Host1       : Q=  -5.74

Step 20: Selected 'Analyse Op_Host0'
  Top 5 Q-values:
    Analyse  Op_Host0       : Q=  -5.63 <-- SELECTED
    Remove   Enterprise1    : Q=  -5.65
    Analyse  Op_Host2       : Q=  -5.69
    Monitor  Defender       : Q=  -5.70
    Remove   Op_Host1       : Q=  -5.74

Step 25: Selected 'Analyse Op_Host0'
  Top 5 Q-values:
    Analyse  Op_Host0       : Q=  -5.63 <-- SELECTED
    Remove   Enterprise1    : Q=  -5.65
    Analyse  Op_Host2       : Q=  -5.69
    Monitor  Defender       : Q=  -5.70
    Remove   Op_Host1       : Q=  -5.74

--- Episode 3 ---

Step 0: Selected 'Monitor'
  Top 5 Q-values:
    Monitor  User4          : Q=  -2.75 <-- SELECTED
    Analyse  Op_Host2       : Q=  -2.77
    Analyse  Op_Host0       : Q=  -2.77
    Analyse  Defender       : Q=  -2.80
    Analyse  Op_Server0     : Q=  -2.80

Step 1: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -5.06 <-- SELECTED
    Analyse  Op_Host0       : Q=  -5.27
    Monitor  User2          : Q=  -5.34
    Monitor  User3          : Q=  -5.38
    Monitor  Op_Host1       : Q=  -5.40

Step 2: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -1.51 <-- SELECTED
    Analyse  User0          : Q=  -1.51
    Analyse  Op_Host0       : Q=  -1.57
    Analyse  User1          : Q=  -1.65
    Analyse  Op_Host2       : Q=  -1.65

Step 3: Selected 'Remove Enterprise1'
  Top 5 Q-values:
    Remove   Enterprise1    : Q=  -3.78 <-- SELECTED
    Monitor  Enterprise0    : Q=  -3.88
    Monitor  Enterprise1    : Q=  -4.05
    Remove   Op_Host2       : Q=  -4.11
    Analyse  Defender       : Q=  -4.15

Step 4: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -5.06 <-- SELECTED
    Analyse  Op_Host0       : Q=  -5.27
    Monitor  User2          : Q=  -5.34
    Monitor  User3          : Q=  -5.38
    Monitor  Op_Host1       : Q=  -5.40

Step 5: Selected 'Analyse User0'
  Top 5 Q-values:
    Analyse  User0          : Q=  -1.78 <-- SELECTED
    Analyse  Op_Server0     : Q=  -1.80
    Analyse  Op_Host0       : Q=  -1.82
    Analyse  Op_Host2       : Q=  -1.87
    Remove   Op_Host0       : Q=  -1.92

Step 6: Selected 'Remove Enterprise1'
  Top 5 Q-values:
    Remove   Enterprise1    : Q=  -3.07 <-- SELECTED
    Analyse  Defender       : Q=  -3.57
    Analyse  User0          : Q=  -3.61
    Remove   User0          : Q=  -3.69
    Remove   Op_Host2       : Q=  -3.69

Step 7: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -5.06 <-- SELECTED
    Analyse  Op_Host0       : Q=  -5.27
    Monitor  User2          : Q=  -5.34
    Monitor  User3          : Q=  -5.38
    Monitor  Op_Host1       : Q=  -5.40

Step 8: Selected 'Remove Enterprise1'
  Top 5 Q-values:
    Remove   Enterprise1    : Q=  -3.07 <-- SELECTED
    Analyse  Defender       : Q=  -3.58
    Analyse  User0          : Q=  -3.63
    Monitor  Enterprise0    : Q=  -3.69
    Remove   User0          : Q=  -3.70

Step 9: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -5.06 <-- SELECTED
    Analyse  Op_Host0       : Q=  -5.27
    Monitor  User2          : Q=  -5.34
    Monitor  User3          : Q=  -5.38
    Monitor  Op_Host1       : Q=  -5.40

Step 10: Selected 'Remove Enterprise1'
  Top 5 Q-values:
    Remove   Enterprise1    : Q=  -3.07 <-- SELECTED
    Analyse  Defender       : Q=  -3.56
    Analyse  User0          : Q=  -3.60
    Remove   User0          : Q=  -3.68
    Remove   Op_Host2       : Q=  -3.68

Step 15: Selected 'Remove Enterprise1'
  Top 5 Q-values:
    Remove   Enterprise1    : Q=  -3.07 <-- SELECTED
    Analyse  Defender       : Q=  -3.58
    Analyse  User0          : Q=  -3.64
    Monitor  Enterprise0    : Q=  -3.69
    Remove   Op_Host2       : Q=  -3.70

Step 20: Selected 'Remove Enterprise1'
  Top 5 Q-values:
    Remove   Enterprise1    : Q=  -3.07 <-- SELECTED
    Analyse  Defender       : Q=  -3.56
    Analyse  User0          : Q=  -3.60
    Remove   User0          : Q=  -3.68
    Remove   Op_Host2       : Q=  -3.68

Step 25: Selected 'Analyse Op_Server0'
  Top 5 Q-values:
    Analyse  Op_Server0     : Q=  -5.06 <-- SELECTED
    Analyse  Op_Host0       : Q=  -5.27
    Monitor  User2          : Q=  -5.34
    Monitor  User3          : Q=  -5.38
    Monitor  Op_Host1       : Q=  -5.40

======================================================================
  Step-wise Action Selection Pattern
======================================================================

Most common action at each step (first 20 steps):
  Step  0: Monitor (3/3 episodes)
  Step  1: Analyse Op_Server0 (3/3 episodes)
  Step  2: Analyse Op_Server0 (3/3 episodes)
  Step  3: Remove Enterprise1 (3/3 episodes)
  Step  4: Analyse Op_Server0 (3/3 episodes)
  Step  5: Analyse User0 (3/3 episodes)
  Step  6: Remove Enterprise1 (3/3 episodes)
  Step  7: Analyse Op_Server0 (3/3 episodes)
  Step  8: Remove Enterprise1 (3/3 episodes)
  Step  9: Analyse Op_Server0 (3/3 episodes)
  Step 10: Remove Enterprise1 (2/3 episodes)
  Step 11: Analyse Op_Server0 (2/3 episodes)
  Step 12: Remove Enterprise1 (3/3 episodes)
  Step 13: Analyse Op_Server0 (3/3 episodes)
  Step 14: Remove Enterprise1 (1/3 episodes)
  Step 15: Analyse Op_Server0 (1/3 episodes)
  Step 16: Analyse Op_Server0 (2/3 episodes)
  Step 17: Analyse Op_Server0 (1/3 episodes)
  Step 18: Remove Enterprise1 (2/3 episodes)
  Step 19: Analyse Op_Server0 (3/3 episodes)

======================================================================
  Q-Value Analysis for Initial State
======================================================================

Q-value statistics (initial state):
  Mean: -3.19
  Std:  0.45
  Min:  -4.39
  Max:  -2.77
  Gap (max-2nd): 0.02

Q-values by action type (initial state):
  Monitor : mean=  -2.97, max=  -2.77, min=  -3.59
  Analyse : mean=  -2.92, max=  -2.79, min=  -3.30
  Remove  : mean=  -2.95, max=  -2.81, min=  -3.30
  Restore : mean=  -3.91, max=  -3.60, min=  -4.39

Top 10 actions by Q-value (initial state):
   1. Monitor  User4          : Q=  -2.77
   2. Analyse  Op_Host2       : Q=  -2.79
   3. Analyse  Op_Host0       : Q=  -2.79
   4. Remove   Enterprise1    : Q=  -2.81
   5. Analyse  Defender       : Q=  -2.81
   6. Analyse  Op_Server0     : Q=  -2.82
   7. Remove   Op_Host1       : Q=  -2.82
   8. Analyse  Enterprise0    : Q=  -2.83
   9. Monitor  Defender       : Q=  -2.83
  10. Monitor  Enterprise0    : Q=  -2.84

======================================================================
  State-Dependency Check
======================================================================

Tracking action changes over episode:
  Step 1: Changed from 'Monitor' to 'Analyse Op_Server0'
  Step 4: Changed from 'Analyse Op_Server0' to 'Remove Enterprise1'
  Step 5: Changed from 'Remove Enterprise1' to 'Analyse Op_Server0'
  Step 6: Changed from 'Analyse Op_Server0' to 'Analyse User0'
  Step 7: Changed from 'Analyse User0' to 'Remove Enterprise1'
  Step 8: Changed from 'Remove Enterprise1' to 'Analyse Op_Server0'
  Step 11: Changed from 'Analyse Op_Server0' to 'Remove Enterprise1'
  Step 12: Changed from 'Remove Enterprise1' to 'Analyse Op_Server0'
  Step 13: Changed from 'Analyse Op_Server0' to 'Analyse User0'
  Step 14: Changed from 'Analyse User0' to 'Remove Enterprise1'

Total action changes in 50 steps: 39
This means the policy is STATE-DEPENDENT
